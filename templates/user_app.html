{% extends "user_nav.html" %}
{% load static %}
{% block title %} Dashboard {% endblock %}
{% block content %}

<style>
    table {
        width: 100%;
        border-collapse: collapse;
        overflow: auto; /* Add overflow property for the table */
    }

    /* Zebra striping */
    tr:nth-of-type(odd) {
        background: #eee;
    }

    th {
        background: #88b4ab;
        color: black;
        font-weight: bold;
    }

    td,
    th {
        padding: 1rem;
        border: 1px solid #ccc;
        text-align: center;
    }

    @media only screen and (max-width: 760px),
    (min-device-width: 768px) and (max-device-width: 1024px) {
        /* Force table to not be like tables anymore */
        table,
        thead,
        tbody,
        th,
        td,
        tr {
            display: block;
        }

        /* Hide table headers (but not display: none;, for accessibility) */
        thead tr {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }

        tr {
            border: 1px solid #ccc;
        }

        td {
            /* Behave like a "row" */
            border: none;
            border-bottom: 1px solid #eee;
            position: relative;
            padding-left: 50%;
        }

        td:before {
            /* Now like a table header */
            position: absolute;
            /* Top/left values mimic padding */
            top: 6px;
            left: 6px;
            width: 45%;
            padding-right: 10px;
            white-space: nowrap;
        }

        /*
        Label the data
        */
        td:nth-of-type(1):before {
            content: "Date";
        }
        td:nth-of-type(2):before {
            content: "Vet Name";
        }
        td:nth-of-type(3):before {
            content: "Appointment Type";
        }
        td:nth-of-type(4):before {
            content: "Service Type";
        }
        td:nth-of-type(5):before {
            content: "Instructions";
        }
        td:nth-of-type(6):before {
            content: "Action";
        }
    }

    /* Style for the "Book Appointment" button */
    .btn-green {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        font-size: 1rem;
        text-decoration: none;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .btn-green:hover {
        background-color: #45a049;
    }

    /* Time Slot styling */
    .time-slot-container {
        width: 100%;
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }

    .time-slot-btn {
        width: 100px;
        height: 40px;
        margin: 5px;
        text-align: center;
        line-height: 40px;
        cursor: pointer;
        border: 1px solid #ced4da;
        border-radius: 5px;
        margin-right: 10px;
        font-size: 0.9rem;
        transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out;
    }

    .available {
        background-color: #53b742;
        color: white;
    }

    .booked {
        background-color: #dc3545;
        color: white;
    }

    .time-slot-btn:hover {
        background-color: #4c9f3e;
    }
</style>



    <!-- Display time slots for booking -->
    <div class="time-slots-container py-5">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div class="fs-4">Bookable Time Slots</div>
            </div>

            <hr />
            <div class="time-slots">
                {% for slot in time_slots %}
                    <button class="time-slot-btn {% if slot.booked %}booked{% else %}available{% endif %}"
                            {% if not slot.booked %}onclick="location.href='{% url 'book_appointment' slot.id %}'"{% endif %}>
                        {{ slot.time }}
                    </button>
                {% endfor %}
            </div>
        </div>
    </div>


<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="fs-4">My Appointment History</div>
        <!-- Add appointment button with link to the booking page -->
        <a href="{% url 'booking' %}" class="text-decoration-none">
            <button type="button" class="book-appointment-btn btn btn-green">Book appointment</button>
        </a>
    </div>

    <div class = "input-group input-group-sm mb-3 mt-4">
        <input type="text" class="form-control" id="search" placeholder="Search for...">
        <a href = "user_app" class="btn btn-primary" style="margin: left 2px;"> <i class="fa-solid fa-magnifying-glass"></i> </a>
    </div>

    <hr />

    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Vet</th>
                <th>Appointment Type</th>
                <th>Service Type</th>
                <th>Instructions</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for app in appoitments %}
                <tr>
                    <td>{{ app.date }}</td>
                    <td>{{ app.vet }}</td>
                    <td>{{ app.appoitment_type }}</td>
                    <td>{{ app.service_type }}</td>
                    <td>none</td>
                    <td>
                        <a href="#" class="btn btn-danger" title="Delete product">
                          <i class="fa-solid fa-trash"></i>
                        </a>
                      </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        // Simulating booked time slots (you would get this data from your server)
        const bookedTimeSlots = ["9:00 AM", "9:20 AM", "9:40 AM", "10:00 AM", "10:20 AM", "10:40 AM", "11:00 AM", "11:20 AM", "10:40 AM", "12:00 PM"];
    
        document.addEventListener("DOMContentLoaded", function () {
            // Generate time slots from 9 am to 5 pm in 20-minute intervals
            const timeSlots = [];
            let currentTime = new Date();
            currentTime.setHours(9, 0, 0, 0); // Set initial time to 9 am
    
            for (let i = 0; i < 24; i++) {
                const time = currentTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const button = document.createElement("button");
                button.className = "time-slot-btn";
                button.textContent = time;
    
                if (bookedTimeSlots.includes(time)) {
                    button.classList.add("booked");
                } else {
                    button.classList.add("available");
                    button.addEventListener("click", function () {
                        alert(`Booked ${time}`);
                    });
                }
    
                document.querySelector('.time-slots').appendChild(button);
                currentTime.setMinutes(currentTime.getMinutes() + 20);
            }
        });
    </script>
    
   
    

</div>

{% endblock %}
